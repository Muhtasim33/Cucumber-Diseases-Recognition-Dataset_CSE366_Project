{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "5d869c80",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2025-11-08T15:55:23.988550Z",
     "iopub.status.busy": "2025-11-08T15:55:23.988186Z",
     "iopub.status.idle": "2025-11-08T15:55:41.596396Z",
     "shell.execute_reply": "2025-11-08T15:55:41.595429Z"
    },
    "papermill": {
     "duration": 17.61355,
     "end_time": "2025-11-08T15:55:41.598242",
     "exception": false,
     "start_time": "2025-11-08T15:55:23.984692",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import time\n",
    "import os\n",
    "import pandas as pd\n",
    "from sklearn.model_selection import train_test_split\n",
    "from torchvision import datasets, transforms\n",
    "from torch.utils.data import DataLoader\n",
    "from sklearn.metrics import classification_report, confusion_matrix\n",
    "import numpy as np\n",
    "import cv2\n",
    "import torch\n",
    "from torch import nn\n",
    "import torch.nn.functional as F\n",
    "from torch.utils.data import DataLoader, Dataset\n",
    "import torchvision\n",
    "from torchvision import transforms\n",
    "from torchinfo import summary\n",
    "import torchvision.models as models\n",
    "import torch.optim as optim\n",
    "from torch.optim.lr_scheduler import StepLR\n",
    "from tqdm.notebook import tqdm\n",
    "from sklearn.metrics import accuracy_score\n",
    "import PIL\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import time\n",
    "from collections import OrderedDict\n",
    "import platform\n",
    "import psutil\n",
    "import random\n",
    "import glob\n",
    "from tqdm import tqdm\n",
    "from PIL import Image\n",
    "from torchvision import transforms\n",
    "from torchvision.transforms import ColorJitter, RandomRotation, RandomResizedCrop\n",
    "from torchvision.transforms.functional import gaussian_blur\n",
    "from PIL import ImageOps\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "d6863659",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2025-11-08T15:55:41.603318Z",
     "iopub.status.busy": "2025-11-08T15:55:41.602879Z",
     "iopub.status.idle": "2025-11-08T15:55:41.622892Z",
     "shell.execute_reply": "2025-11-08T15:55:41.621824Z"
    },
    "papermill": {
     "duration": 0.024183,
     "end_time": "2025-11-08T15:55:41.624415",
     "exception": false,
     "start_time": "2025-11-08T15:55:41.600232",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Device set to: cpu\n",
      "\n",
      "Configuration Summary:\n",
      "Project Focus: Cucumber Disease Recognition\n",
      "Data Source: /kaggle/input/original-image-of-cucumber-disease-recognition/Original Image\n",
      "Output Directory: /kaggle/working/processed-dataset\n",
      "Total Classes: 8\n",
      "Learning Rate: 0.0001\n",
      "Total Epochs: 100\n"
     ]
    }
   ],
   "source": [
    "import torch\n",
    "import os\n",
    "import numpy as np\n",
    "import random\n",
    "\n",
    "# 1. Reproducibility Setup \n",
    "# Setting seeds for all relevant libraries to ensure consistent results\n",
    "seed = 1\n",
    "torch.manual_seed(seed)\n",
    "if torch.cuda.is_available():\n",
    "    # Only set CUDA seed if a GPU is available\n",
    "    torch.cuda.manual_seed(seed)\n",
    "    # torch.backends.cudnn.deterministic = True # Uncomment for maximum determinism (might impact performance)\n",
    "    # torch.backends.cudnn.benchmark = False    # Uncomment for maximum determinism\n",
    "np.random.seed(seed)\n",
    "random.seed(seed)\n",
    "\n",
    "# 2. Hardware and Paths \n",
    "\n",
    "# Device selection: use CUDA (GPU) if available, otherwise fall back to CPU\n",
    "device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')\n",
    "print(f\"Device set to: {device}\")\n",
    "\n",
    "# Directory paths (Updated for Cucumber Disease Recognition Project)\n",
    "# NOTE: You may need to adjust the specific folder name based on your mounted dataset.\n",
    "data_dir = \"/kaggle/input/original-image-of-cucumber-disease-recognition/Original Image\"\n",
    "output_dir = \"/kaggle/working/processed-dataset\"\n",
    "checkpoints_path = \"/kaggle/working/\"\n",
    "\n",
    "# Ensure output directories exist\n",
    "os.makedirs(output_dir, exist_ok=True)\n",
    "os.makedirs(checkpoints_path, exist_ok=True)\n",
    "\n",
    "# 3. Hyperparameters and Training Configuration \n",
    "\n",
    "# Batch sizes\n",
    "train_batch = 32\n",
    "test_batch = 16\n",
    "\n",
    "# Model/Training parameters\n",
    "# Updated total_class from 3 to 8, a common count for cucumber disease datasets\n",
    "total_class = 8         # Number of classes (e.g., Healthy, Anthracnose, Downy Mildew, etc.)\n",
    "learning_rate = 0.0001  # Initial learning rate\n",
    "decay = 1e-4            # Weight decay (L2 regularization)\n",
    "epoch = 100             # Total number of epochs to train\n",
    "patience = 100          # Patience for early stopping (e.g., how many epochs to wait for improvement)\n",
    "\n",
    "print(\"\\nConfiguration Summary:\")\n",
    "print(f\"Project Focus: Cucumber Disease Recognition\")\n",
    "print(f\"Data Source: {data_dir}\")\n",
    "print(f\"Output Directory: {output_dir}\")\n",
    "print(f\"Total Classes: {total_class}\")\n",
    "print(f\"Learning Rate: {learning_rate}\")\n",
    "print(f\"Total Epochs: {epoch}\")"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "none",
   "dataSources": [
    {
     "datasetId": 8508644,
     "sourceId": 13407094,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 31192,
   "isGpuEnabled": false,
   "isInternetEnabled": false,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 25.461512,
   "end_time": "2025-11-08T15:55:44.191815",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2025-11-08T15:55:18.730303",
   "version": "2.6.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
